
<div class="sidebar" [class.open]="isSidebarOpen">

  <h1 style="font-size: 2.5rem;">Filters</h1>
    <h2>Date Range</h2>
    <div class="date-range">
      <label for="startDate" >Start Date:</label>
      <input type="date" id="startDate" name="startDate" [(ngModel)]="startDate">
      <label for="endDate">End Date:</label>
      <input type="date" id="endDate" name="endDate" [(ngModel)]="endDate">
    </div>
    <h2>Filter Options</h2>
    <form (submit)="applyFilters(); $event.preventDefault();">
      <div class="filter-option">
        <input type="checkbox" id="grantedCheckbox" [(ngModel)]="displayGranted" name="grantedFilter"
          (ngModelChange)="onGrantedCheckboxChange()">
        <label for="grantedCheckbox">Granted</label>
      </div>
      <div class="filter-option">
        <input type="checkbox" id="pregrantedCheckbox" [(ngModel)]="displayPregranted" name="pregrantFilter"
          (ngModelChange)="onPregrantedCheckboxChange()">
        <label for="pregrantedCheckbox">Pregranted</label>
      </div>
    </form>

    <br><br>
    <h1 style="font-size: 2.5rem;">History</h1>
    <ul class="search-history-list">
      <li 
          *ngFor="let search of recentSearches"
          class="search-history-item" 
          [class.active]="activeSearch === search.query"
          (click)="onSearchHistoryClick(search)">
          <span class="search-history-query">{{ search.query }}</span>
          <br>
          <span class="search-history-time">{{ search.timestamp | date:'shortTime' }}</span>
          <br>
          <i  class="fa fa-trash-o" (click)="onDeleteSearchHistory(search.key, $event)"></i>
      </li>
  </ul> 

  
  
</div> 



<section id="search-bar-area">
  <h1 id="logo">
    <a href="#">
    <span *ngFor="let letter of titleLetters; let i = index"
          class="letter" [class.animate]="isSearching" [style.animation-delay]="(i * 0.2) + 's'">
      {{ letter }}
    </span>
    </a>
  </h1>

  <form class="search-form" (submit)="search(); $event.preventDefault();">
    <!-- Search Input -->
    <div class="search-input-container">
      <textarea class="search-input" placeholder="Search..." [(ngModel)]="queryValue" name="queryValue" required></textarea>
      <input matInput [matDatepicker]="picker" style="display: none" [(ngModel)]="selectedDate" name="selectedDate">
      <mat-datepicker touchUi="true" #picker class="cdk-overlay-transparent-backdrop"></mat-datepicker>

      <div class="icon-buttons-container">
        <button mat-icon-button (click)="picker.open()" class="icon-button" type="button" [disabled]="isSubmitting">
          <i class="fa fa-calendar"></i>
        </button>

        <button class="search-button" [disabled]="isSubmitting">
          <i class="fa fa-search"></i>
        </button>

      </div>

    </div>

  </form>

  <a (click)="routeSaved()" class="minimalistic-button">Projects</a>
</section>


<div class="pagination">
  <ul>
    <li *ngFor="let page of getPages()">
      <a href="#" [class.activePage]="page === currentPage" (click)="changePage(page); $event.preventDefault()">{{ page
        }}</a>
    </li>
  </ul>
</div>

<div class="page-container">
  <aside class="filter-sidebar">
    <h1>Filters</h1>
    <h2>Date Range</h2>
    <div class="date-range">
      <label for="startDate" >Start Date:</label>
      <input type="date" id="startDate" name="startDate" [(ngModel)]="startDate">
      <label for="endDate">End Date:</label>
      <input type="date" id="endDate" name="endDate" [(ngModel)]="endDate">
    </div>
    <h2>Filter Options</h2>
    <form (submit)="applyFilters(); $event.preventDefault();">
      <div class="filter-option">
        <input type="checkbox" id="grantedCheckbox" [(ngModel)]="displayGranted" name="grantedFilter"
          (ngModelChange)="onGrantedCheckboxChange()">
        <label for="grantedCheckbox">Granted</label>
      </div>
      <div class="filter-option">
        <input type="checkbox" id="pregrantedCheckbox" [(ngModel)]="displayPregranted" name="pregrantFilter"
          (ngModelChange)="onPregrantedCheckboxChange()">
        <label for="pregrantedCheckbox">Pregranted</label>
      </div>
    </form>
</aside>

  <!-- Custom Sidebar for Search History -->
  <aside class="search-history-sidebar">
    <h1 class="sidebar-title">History</h1>
    <ul class="search-history-list">
      <li 
          *ngFor="let search of recentSearches"
          class="search-history-item" 
          [class.active]="activeSearch === search.query"
          (click)="onSearchHistoryClick(search)">
          <span class="search-history-query">{{ search.query }}</span>
          <br>
          <span class="search-history-time">{{ search.timestamp | date:'shortTime' }}</span>
          <br>
          <i  class="fa fa-trash-o" (click)="onDeleteSearchHistory(search.key, $event)"></i>
      </li>
  </ul> 
    
  </aside>

<section class="patents-section" [class.expanded]="showResults">
  <br>
  <div class="open-sidebar-button" (click)="toggleSidebar()">
    <i class="fa fa-bars"></i>
  </div>
  
  <br>
  <h1 class=""></h1>
  <br>
  <div *ngFor="let patent of getDisplayedResults().currentResults; let i = index" [class.saved-patent]="isSaved(patent)" class="patent-box"
    [@expandCollapse]="patent.state" (click)="togglePatent(patent)">
    <div class="similarity-badge" 
     [style.background-color]="getSimilarityBadge(patent.similarity_score).color">
  <span>{{ getSimilarityBadge(patent.similarity_score).label }} <br> <div  style="text-align: center;">{{patent.type}}</div>  </span>
</div>

    <h2>{{ patent.title }} <br>
      <div *ngIf="grantedResults">US{{patent.patent_id}} </div>
      <div *ngIf="pregrantedResults">{{patent.application_id}}</div>
    </h2>
    <p>{{ patent.abstract }}</p>
    <div class="more-info" *ngIf="patent.state === 'expanded'">
      <h2>Summary</h2>
      <p>{{ patent.summary }}</p>
      <h2>Claims</h2>
      <p>{{ patent.claims }}</p>

    </div>

    <div class="patent-buttons">
      <!-- <span class="patent-button" (click)="stopPropagation($event)"> Open Document </span> !-->
      <span class="patent-button" (click)="openUSPTO(patent.patent_id); stopPropagation($event)">
        <a href="https://image-ppubs.uspto.gov/dirsearch-public/print/downloadPdf/{{ patent.patent_id }}" target="_blank">USPTO</a>
      </span>
      <span class="patent-button" (click)="stopPropagation($event)">
        <a href="https://patents.google.com/patent/US{{ patent.patent_id }}" target="_blank">Google Patents</a>
      </span>

      <div class="dropdown">
        <div class="dropdown-btn">Save to Project </div>
        <div class="dropdown-content">
            <a href="#">Option 1</a>
            <a href="#">Option 2</a>
            <a href="#">Option 3</a>
            <a href="#">Option 3</a>
            <a href="#">Option 3</a>
            <a href="#">Option 3</a>
        </div>
      </div>  
    </div>
  </div>

</section>
